/*!
 * Draggabilly PACKAGED v2.2.1
 * Make that shiz draggable
 * https://draggabilly.desandro.com
 * MIT license
 */

!function(o,e){"function"==typeof define&&define.amd?define(["get-size/get-size","unidragger/unidragger"],function(t,i){return e(o,t,i)}):"object"==typeof module&&module.exports?module.exports=e(o,require("get-size"),require("unidragger")):o.Draggabilly=e(o,o.getSize,o.Unidragger)}(window,function(s,h,t){"use strict";function o(t,i){for(var o in i)t[o]=i[o];return t}function i(t){return t instanceof HTMLElement}var e=s.jQuery;function n(t,i){this.element="string"==typeof t?document.querySelector(t):t,e&&(this.$element=e(this.element)),this.options=o({scrollSpeed:10,autoScrollThreshold:30},this.constructor.defaults),this.option(i),this._create()}var r=n.prototype=Object.create(t.prototype);n.defaults={},r.option=function(t){o(this.options,t)};var l={relative:!0,absolute:!0,fixed:!0};function a(t,i,o){return o=o||"round",i?Math[o](t/i)*i:t}return r._create=function(){this.position={},this._getPosition(),this.startPoint={x:0,y:0},this.dragPoint={x:0,y:0},this.startPosition=o({},this.position);var t=getComputedStyle(this.element);l[t.position]||(this.element.style.position="relative"),this.on("pointerDown",this.onPointerDown),this.on("pointerMove",this.onPointerMove),this.on("pointerUp",this.onPointerUp),this.enable(),this.setHandles()},r.setHandles=function(){this.handles=this.options.handle?this.element.querySelectorAll(this.options.handle):[this.element],this.bindHandles(),this.options.parentScroll&&(this.options.parentScroll=i(this.options.parentScroll)?this.options.parentScroll:"string"==typeof this.options.parentScroll?document.querySelector(this.options.parentScroll):this.element.parentNode,this.options.parentScroll.addEventListener("scroll",this))},r.dispatchEvent=function(t,i,o){var e=[i].concat(o);this.emitEvent(t,e),this.dispatchJQueryEvent(t,i,o)},r.dispatchJQueryEvent=function(t,i,o){var e=s.jQuery;if(e&&this.$element){var n=e.Event(i);n.type=t,this.$element.trigger(n,o)}},r._getPosition=function(){var t=getComputedStyle(this.element),i=this._getPositionCoord(t.left,"width"),o=this._getPositionCoord(t.top,"height");this.position.x=isNaN(i)?0:i,this.position.y=isNaN(o)?0:o,this._addTransformPosition(t)},r._getPositionCoord=function(t,i){if(-1==t.indexOf("%"))return parseInt(t,10);var o=h(this.element.parentNode);return o?parseFloat(t)/100*o[i]:0},r._addTransformPosition=function(t){var i=t.transform;if(0===i.indexOf("matrix")){var o=i.split(","),e=0===i.indexOf("matrix3d")?12:4,n=parseInt(o[e],10),s=parseInt(o[1+e],10);this.position.x+=n,this.position.y+=s}},r.onPointerDown=function(t,i){this.element.classList.add("is-pointer-down"),this.dispatchJQueryEvent("pointerDown",t,[i])},r.dragStart=function(t,i){this.isEnabled&&(this._getPosition(),this.measureContainment(),this.scrollOffset=this.measureScrollOffset(),this.startPosition.x=this.position.x,this.startPosition.y=this.position.y,this.setLeftTop(),this.dragPoint.x=0,this.dragPoint.y=0,this.lastKnownMoveVector={x:0,y:0},this.element.classList.add("is-dragging"),this.dispatchEvent("dragStart",t,[i]),this.animate())},r.measureContainment=function(){var t=this.getContainer();if(t){var i=h(this.element),o=h(t),e=this.element.getBoundingClientRect(),n=t.getBoundingClientRect(),s=o.borderLeftWidth+o.borderRightWidth,r=o.borderTopWidth+o.borderBottomWidth,l=this.relativeStartPosition={x:e.left-(n.left+o.borderLeftWidth),y:e.top-(n.top+o.borderTopWidth)};this.containSize={width:o.width-s-l.x-i.width,height:o.height-r-l.y-i.height}}},r.getContainer=function(){var t=this.options.containment;if(t)return t instanceof HTMLElement?t:"string"==typeof t?document.querySelector(t):this.element.parentNode},r.measureScrollOffset=function(){if(this.options.parentScroll)return this.options.parentScroll=i(this.options.parentScroll)?this.options.parentScroll:"string"==typeof this.options.parentScroll?document.querySelector(this.options.parentScroll):this.options.parentScroll=this.element.parentNode,{top:this.options.parentScroll.scrollTop,left:this.options.parentScroll.scrollLeft}},r.onPointerMove=function(t,i,o){this.dispatchJQueryEvent("pointerMove",t,[i,o])},r.dragMove=function(t,i,o){if(this.isEnabled){isNaN(o.x)||isNaN(o.y)?o=this.lastKnownMoveVector:this.lastKnownMoveVector=o,this.checkAutoScroll(i);var e=o.x,n=o.y,s=this.options.grid,r=s&&s[0],l=s&&s[1];e=this.applyScrollOffset("x",e),n=this.applyScrollOffset("y",n),e=a(e,r),n=a(n,l),e=this.containDrag("x",e,r),n=this.containDrag("y",n,l),e="y"==this.options.axis?0:e,n="x"==this.options.axis?0:n,this.position.x=this.startPosition.x+e,this.position.y=this.startPosition.y+n,this.options.scale&&(e/=this.options.scale,n/=this.options.scale),this.dragPoint.x=e,this.dragPoint.y=n,this.dispatchEvent("dragMove",t,[i,o])}},r.checkAutoScroll=function(t){if(this.options.parentScroll&&this.options.autoScroll){var i=this.options.parentScroll.getBoundingClientRect();t.clientY-this.options.autoScrollThreshold<=i.top?this.autoScrollYDirection=-1:t.clientY+this.options.autoScrollThreshold>=i.top+i.height?this.autoScrollYDirection=1:this.autoScrollYDirection=0}else this.autoScrollYDirection=0},r.onscroll=function(t){this.isEnabled&&this.isDragging&&this.onmousemove(t)},r.applyScrollOffset=function(t,i){if(!this.options.parentScroll)return i;var o="x"==t?"left":"top";return i+(this.measureScrollOffset()[o]-this.scrollOffset[o])},r.containDrag=function(t,i,o){if(!this.options.containment)return i;var e="x"==t?"width":"height",n=a(-this.relativeStartPosition[t],o,"ceil"),s=this.containSize[e];return s=a(s,o,"floor"),Math.max(n,Math.min(s,i))},r.onPointerUp=function(t,i){this.element.classList.remove("is-pointer-down"),this.dispatchJQueryEvent("pointerUp",t,[i])},r.dragEnd=function(t,i){this.isEnabled&&(this.element.style.transform="",this.setLeftTop(),this.element.classList.remove("is-dragging"),this.dispatchEvent("dragEnd",t,[i]))},r.animate=function(){if(this.isDragging){this.performAutoScroll(),this.positionDrag();var t=this;requestAnimationFrame(function(){t.animate()})}},r.setLeftTop=function(){this.element.style.left=this.position.x+"px",this.element.style.top=this.position.y+"px"},r.setScale=function(t){this.options.scale=t},r.getScale=function(){return this.options.scale},r.performAutoScroll=function(){1!==this.autoScrollYDirection&&-1!==this.autoScrollYDirection||(this.options.parentScroll.scrollTop=this.options.parentScroll.scrollTop+this.options.scrollSpeed*this.autoScrollYDirection)},r.positionDrag=function(){this.element.style.transform="translate3d( "+this.dragPoint.x+"px, "+this.dragPoint.y+"px, 0)"},r.staticClick=function(t,i){this.dispatchEvent("staticClick",t,[i])},r.setPosition=function(t,i){this.position.x=t,this.position.y=i,this.setLeftTop()},r.enable=function(){this.isEnabled=!0},r.disable=function(){this.isEnabled=!1,this.isDragging&&this.dragEnd()},r.destroy=function(){this.disable(),this.element.style.transform="",this.element.style.left="",this.element.style.top="",this.element.style.position="",this.unbindHandles(),this.options.parentScroll&&(this.options.parentScroll=i(this.options.parentScroll)?this.options.parentScroll:"string"==typeof this.options.parentScroll?document.querySelector(this.options.parentScroll):this.element.parentNode,this.options.parentScroll.addEventListener("scroll",this)),this.$element&&this.$element.removeData("draggabilly")},r._init=function(){},e&&e.bridget&&e.bridget("draggabilly",n),n});